# ネスト

_ヒーリング_ の魔法で HP を回復させたときに現在 HP が最大 HP を超えてしまわないように、次のようなコードを書きました。

```swift
hp += 80
if hp > maxHP {
  hp = maxHP
}
```

しかし、 _ヒーリング_ に必要な条件はこれだけではありません。 _ヒーリング_ では死んでしまった仲間を生き返らせることはできないので、その仲間が生きているとき（現在 HP が 0 より大きいとき）のみ効くようにしなければなりません。これを _コード_ で書くと次のようになります。

```swift
if hp > 0 {
  hp += 80
  if hp > maxHP {
    hp = maxHP
  }
}
```

勇者が生きている（ `hp` が `0` より大きい）ときのみ最初の `if` の `{ }` の中に進み、 `hp += 80` で HP を回復させ、さらに `hp` が `maxHP` を超えてしまった場合には `hp` が `maxHP` と同じになるようにしています。

この _コード_ では `if` の `{ }` の中にもう一つ `if` があります。このように、 _if 文_ などを重ねて入れ子にすることを **_ネスト_** と言います。

_ネスト_ できるのは `if` の `{ }` の中だけではありません。 `else` の `{ }` の中でもできます。

たとえば、↑のコードでは HP の計算をしているだけで <code class="sq-output">そうりょはヒーリングのまほうをつかった。</code> や <code class="sq-output">ゆうしゃのHPがかいふくした。</code> などの表示を行っていませんが、もし勇者が死んでいる（ `hp` が `0` の）ときに <code class="sq-output">ゆうしゃにはきかなかった。</code> と表示するためには `else` も使って分岐しなければなりません。

```swift
print("そうりょはヒーリングのまほうをつかった。")
if hp == 0 {
  print("ゆうしゃにはきかなかった。")
} else {
  print("ゆうしゃのHPがかいふくした。")
}
```

この `else` の `{ }` の中で勇者の HP を回復させたいわけですが、現在 HP が最大 HP を超えてしまってはいけないので、次のように `else` の `{ }` の中にもう一つ `if` が必要になります。

```swift
print("そうりょはヒーリングのまほうをつかった。")
if hp == 0 {
  print("ゆうしゃにはきかなかった。")
} else {
  hp += 80
  if hp > maxHP {
    hp = maxHP
  }
  print("ゆうしゃのHPがかいふくした。")
}
```

↑の _コード_ では `maxHP` や `hp` の _宣言_ を省略しているので、それらも含む完成した _コード_ は↓です。

```swift
let maxHP = 153
let hp = 132

print("そうりょはヒーリングのまほうをつかった。")
if hp == 0 {
  print("ゆうしゃにはきかなかった。")
} else {
  hp += 80
  if hp > maxHP {
    hp = maxHP
  }
  print("ゆうしゃのHPがかいふくした。")
}
```

_ネスト_ は何重でもすることができます。次のような _コード_ も正しいコードです。

```swift
let a = 2
let b = 3
let c = 5
let d = 7
let e = 11
let f = 13
let g = 17

if a < b {
  if b < c {
    if c < d {
      if d < e {
        if e < f {
          if f < g {
            print("gが最大")
          }
        }
      }
    }
  }
}
```

## 練習問題

### 問 1

### 問 2

#### 勇者が死んでいる場合

```
HP XX

まおうのこうげき。
ゆうしゃはすでにしんでいる。

HP XX
```

#### 勇者が生きており、攻撃された後も生きている場合

```
HP XX

まおうのこうげき。
ゆうしゃにXXのダメージ！

HP XX
```

#### 勇者が生きており、攻撃されて死んでしまった場合

```
HP XX

まおうのこうげき。
ゆうしゃにXXのダメージ！
ゆうしゃはしんでしまった。

HP 0
```

### 問 3

_ヒーリング_ を使うには MP を 5 消費します。もし _ヒーリング_ を使おうとしたときに MP が 5 より少ないと _ヒーリング_ を使えません。一般的には行動を選択する際に MP が 5 より少ないと _ヒーリング_ を選択できませんが、敵に MP を吸い取られるなどして実際に行動するときに MP が足りないケースがあります。

勇者の HP と僧侶の MP が次のように与えられているとき、 _コード_ 続きを書いて僧侶が勇者に _ヒーリング_ をかける _プログラム_ を完成させて下さい。

```swift
let name1 = "ゆうしゃ"
let maxHP1 = 153
var hp1 = 132 // 他の値でも良い

let name2 = "そうりょ"
var mp2 = 10 // 他の値でも良い

print(name1)
print("HP \(hp1)")
print()

print(name2)
print("MP \(mp2)")
print()
```

僧侶が勇者に _ヒーリング_ をかけた場合に起こることは次の通りです。

- 僧侶の MP が足りない場合は僧侶の MP は減らず、勇者の HP も回復しない。
- 僧侶の MP が足りる場合は _ヒーリング_ が使えるので僧侶の MP を 5 減らす。
- 勇者が死んでいるときは勇者の HP は回復しない。
- 勇者が生きているときは勇者の HP が 80 回復する。ただし、 HP は最大 HP を超えて回復することはない。　

そのとき、 _プログラム_ は次のように表示するようにして下さい。ただし、 <code class="sq-output">XX</code> の部分には適切な値が入るものとします。

#### 僧侶の MP が足りない場合

```
ゆうしゃ
HP XX

そうりょ
MP XX

そうりょはヒーリングのまほうをつかった。
しかしMPがたりない。

ゆうしゃ
HP XX

そうりょ
MP XX
```

#### 僧侶の MP は足りているが勇者が死んでいる場合

```
ゆうしゃ
HP 0

そうりょ
MP XX

そうりょはヒーリングのまほうをつかった。
ゆうしゃにはきかなかった。

ゆうしゃ
HP 0

そうりょ
MP XX
```

#### 僧侶の MP が足りていて勇者が生きている場合

```
ゆうしゃ
HP XX

そうりょ
MP XX

そうりょはヒーリングのまほうをつかった。
ゆうしゃのHPがかいふくした。

ゆうしゃ
HP XX

そうりょ
MP XX
```

## 答え

### 問 1

### 問 2

```swift
var hp = 20 // 他の値でも良い
let damage = 44 // 他の値でも良い

print("HP \(hp)")
print()

print("まおうのこうげき。")
if hp == 0 {
  print("ゆうしゃはすでにしんでいる。")
} else {
  print("ゆうしゃに\(damage)のダメージ！")
  if hp > damage {
    hp -= damage
  } else {
    print("ゆうしゃはしんでしまった。")
    hp = 0
  }
}
print()

print("HP \(hp)")
```

### 問 3

```swift
let name1 = "ゆうしゃ"
let maxHP1 = 153
var hp1 = 132 // 他の値でも良い

let name2 = "そうりょ"
var mp2 = 10 // 他の値でも良い

print(name1)
print("HP \(hp1)")
print()

print(name2)
print("MP \(mp2)")
print()

print("\(name2)はヒーリングのまほうをつかった。")
if mp2 < 5 {
  print("しかしMPがたりない。")
} else {
  mp2 -= 5

  if hp1 == 0 {
    print("\(name1)にはきかなかった。")
  } else {
    hp1 += 80
    if hp1 > maxHP1 {
      hp1 = maxHP1
    }
    print("\(name1)のHPがかいふくした。")
  }
}
print()

print(name1)
print("HP \(hp1)")
print()

print(name2)
print("MP \(mp2)")
```
